<h1>CIVCARDS TEST</h1>

<!-- Lets make a simple snake game -->
<canvas id="canvas" width="550" height="310"></canvas>

<!-- Jquery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script src="deck.js" type="text/javascript"></script>
<script src="cards.js" type="text/javascript"></script>
<script src="board.js" type="text/javascript"></script>

<script>
  $(document).ready(function(){
	  //Canvas stuff
	  var canvas = $("#canvas")[0];
	  var ctx = canvas.getContext("2d");
	  var w = $("#canvas").width();
	  var h = $("#canvas").height();
    
    // draw deck and hand
		var player = {}; 
		player.deck = shuffleDeck(createDeck())
    player.hand = [];
		var board = createBoard();
	  
	  
    while (player.hand.length < 3) { drawCard(player.deck, player.hand); }
    
    ctx.font = "20px Arial";
    
    drawBoard(ctx, board);
   	drawDeckHand(player.deck, player.hand, ctx);
  });
                    
  function drawDeckHand(deck, hand, ctx) {
		drawField(ctx, 0, 4, { name: deck.length }, null);
  	for(i = 0; i < 3; i++) {
			drawField(ctx, 2 + i, 4, hand[i], null);
  	}
  }
	
	function drawBoard(ctx, board) {
		for(i = 0; i < 9; i++) {
			for(j = 0; j < 3; j++) {
				drawField(ctx, i, j, board[i,j].card, board[i,j]);
			}
		}
	}

  function drawField(ctx, x, y, card, field) {
  	ctx.beginPath();
		ctx.lineWidth = getWidth(card, field);
		ctx.strokeStyle = getColor(card, field);
		ctx.rect(10 + x*60 ,10 + y*60,50,50); 
		ctx.stroke();
		if (card) {
			ctx.fillText(card.name.substring(0,2), 25 + x*60, 15 + y*60);
		}
  }
	
	function getWidth(card, field) {
		if (card) { return 3; }
		if (field.build) { return 2; }
		return 1;
	}
	
	function getColor(card, field) {
		if (card) {
			return card.owner == 'PLAYER' ? "green" : "red";
		}
		if (field) {
			if(field.build) {
				return field.build == 'PLAYER' ? "darkgreen" : "darkred";
			}
			if (field.units) {
				return field.units == 'PLAYER' ? "darkgreen" : "darkred";
			}
			return "black";
		}
		return "black";
	}
</script>
